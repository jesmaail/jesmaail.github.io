<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Joseph Esmaail - Blog</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="../width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="../assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->

		<!-- Syntax Highligher - EnlighterJS -->
		<link rel="stylesheet" type="text/css" href="../assets/css/EnlighterJS.min.css"/>
		<script type="text/javascript" src="../assets/js/MooTools-Core-1.6.0.js"></script>
		<script type="text/javascript" src="../assets/js/EnlighterJS.min.js"></script>

		<meta name="EnlighterJS" content="Advanced javascript based syntax highlighting" data-indent="4" data-selector-block="pre" data-selector-inline="code" data-language="C#" />
	</head>
	<body>

		<!-- Sidebar -->
			<section id="sidebar">
				<div class="inner">
					<nav>
						<ul>
							<li>Joseph Esmaail</li>
							<li><a href="../blog.html"><b>Blog</b></a></li>
							<li><a href="../index.html#intro">Summary</a></li>
							<li><a href="../index.html#one">Academia & Experience</a></li>
							<li><a href="../index.html#two">Skills & Projects</a></li>
							<li><a href="../index.html#three">Interests/Other</a></li>
							<li><a href="../index.html#four">Contact</a></li>
						</ul>
					</nav>
				</div>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<section class="wrapper style1 fade-up">
					<div class="inner">
						<h2>ASP.Net Core Web API & XML</h2>
						<p>
							How to use XML for a Web API developed in .Net Core.
						</p>
						</div>
				</section>

				<section class="wrapper fade-up">
					<div class="inner">
						A good introduction for developing a web API in ASP.Net Core can be found <a href="https://docs.asp.net/en/latest/tutorials/first-web-api.html">here.</a> That tutorial does however use a trivial model class, and does not cover the extra steps required to make it entirely compatible with XML.
					</div>
					<hr/>
				</section>

				<section class="wrapper fade-up">
					<div class="inner">
					<h3>First Steps</h3>
						Add the following code to the <i>ConfigureServices</i> method in the <i>Startup.cs</i> file in your project.
						<br/>
						<pre>
services.AddMvc(config =>
{
	config.RespectBrowserAcceptHeader = true;
	config.InputFormatters.Add(new XmlSerializerInputFormatter());
	config.OutputFormatters.Add(new XmlDataContractSerializerOutputFormatter());
});
            			</pre>
            			You'll also want to add:<br/>
            			<pre>
using Microsoft.AspNetCore.Mvc.Formatters;
						</pre>
						The API can now handle XML as well as JSON formats.

					</div>
					<hr/>
				</section>

				<section class="wrapper fade-up">
					<div class="inner">
					<h3>XML Attributes and ASP.Net Core</h3>
					That will work for straightforward XML without attributes, however we will need to add a few things to out model class(es) if we want to use attributes.<br/>
					The best way to explain this is to use an example. 
					<br/>
					We want to have the API be able to accept an XML document that looks like:
					<pre>
&lt;Band&gt;
	&lt;BandMembers&gt;
		&lt;BandMember name="Phil"&gt;
			&lt;Instrument&gt;Vocals&lt;/Instrument&gt;
			&lt;Availability&gt;Saturdays&lt;\Availability&gt;
		&lt;/BandMember&gt;
		&lt;BandMember name="Dave"&gt;
			&lt;Instrument&gt;Guitar&lt;/Instrument&gt;
			&lt;Availability&gt;Weekends&lt;\Availability&gt;
		&lt;/BandMember&gt;
		&lt;BandMember name="James"&gt;
			&lt;Instrument&gt;Bass&lt;/Instrument&gt;
			&lt;Availability&gt;Everyday&lt;\Availability&gt;
		&lt;/BandMember&gt;
		&lt;BandMember name="Chris"&gt;
			&lt;Instrument&gt;Drums&lt;/Instrument&gt;
			&lt;Availability&gt;Weekends&lt;\Availability&gt;
		&lt;/BandMember&gt;
	&lt;/BandMembers&gt;
	&lt;Gigs&gt;
		&lt;Gig venue="Motorpoint Arena" date="01/01/2010"&gt;
		&lt;Gig venue="Brangwyn Hall" date="10/01/2010"&gt;
	&lt;/Gigs&gt;
&lt;/Band&gt;
					</pre>
					So the classes we want for our model should look like:
					<pre>
public class Band
{
	public List&lt;Member&gt; BandMembers { get; set; }
	public List&lt;Gig&gt; Gigs { get; set; }
}
					</pre>
					<pre>

using System.Xml.Serialization;

[XmlRoot("BandMember")]
public class BandMember
{
	[XmlAttribute(AttributeName = "name")]
	public string Name { get; set; }
	public string Instrument { get; set; }
	public string Availability { get; set; }
}
					</pre>
					<pre>
using System.Xml.Serialization;

[XmlRoot("Gig")]
public class Gig
{
	[XmlAttribute(AttributeName = "venue")]
	public string Venue { get; set; }
	[XmlAttrivute(AttributeName = "date")]
	public string Date { get; set; }
}
					</pre>
					</div>
					<hr/>
				</section>
			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper style1-alt">
				<div class="inner">
					<ul class="menu">
						<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>